<view class="container">
  <view class="header">
    <view class="title">查询板件 / 包裹 / 托盘</view>
    <view class="subtitle">支持扫码或输入编码进行查询</view>
  </view>

  <view class="search-box">
    <input class="code-input" placeholder="请输入编码或扫码" value="{{code}}" bindinput="onInput" confirm-type="search" bindconfirm="doSearch" />
    <view class="actions">
      <button class="btn scan" bindtap="scanSearch">扫码查询</button>
      <button class="btn search" bindtap="doSearch">编码查询</button>
    </view>
  </view>

  <view wx:if="{{loading}}" class="loading">查询中...</view>
  <view wx:if="{{error}}" class="error">{{error}}</view>

  <view wx:if="{{result}}" class="result">
    <view class="result-type">类型：{{result.type === 'component' ? '板件' : result.type === 'package' ? '包裹' : result.type === 'pallet' ? '托盘' : '未知'}}</view>
    <view class="card">
      <!-- 板件信息展示 -->
      <view wx:if="{{result.type === 'component'}}">
        <view class="row"><text class="label">板件名称</text><text class="value">{{result.data.component_name}}</text></view>
        <view class="row"><text class="label">板件编码</text><text class="value">{{result.data.component_code}}</text></view>
        <view class="row"><text class="label">订单号</text><text class="value">{{result.data.order_number}}</text></view>
        <view class="row"><text class="label">材质</text><text class="value">{{result.data.material}}</text></view>
        <view class="row"><text class="label">成品尺寸</text><text class="value">{{result.data.finished_size}}</text></view>
        <view class="row"><text class="label">房间号</text><text class="value">{{result.data.room_number}}</text></view>
        <view class="row"><text class="label">柜号</text><text class="value">{{result.data.cabinet_number}}</text></view>
        <view class="row"><text class="label">状态</text><text class="value">{{result.data.status}}</text></view>
        <view class="row"><text class="label">包装ID</text><text class="value">{{result.data.package_id}}</text></view>
      </view>

      <!-- 包裹信息展示 -->
      <view wx:if="{{result.type === 'package'}}">
        <view class="row"><text class="label">包裹号</text><text class="value">{{result.data.package_number}}</text></view>
        <view class="row"><text class="label">订单号</text><text class="value">{{result.data.order_number}}</text></view>
        <view class="row"><text class="label">板件数量</text><text class="value">{{result.data.component_count}}</text></view>
        <view class="row"><text class="label">托盘ID</text><text class="value">{{result.data.pallet_id}}</text></view>
        <view class="row"><text class="label">状态</text><text class="value">{{result.data.status}}</text></view>
      </view>

      <!-- 托盘信息展示 -->
      <view wx:if="{{result.type === 'pallet'}}">
        <view class="row"><text class="label">托盘号</text><text class="value">{{result.data.pallet_number}}</text></view>
        <view class="row"><text class="label">托盘类型</text><text class="value">{{result.data.pallet_type}}</text></view>
        <view class="row"><text class="label">包裹数量</text><text class="value">{{result.data.package_count}}</text></view>
        <view class="row"><text class="label">状态</text><text class="value">{{result.data.status}}</text></view>
      </view>
    </view>
  </view>

  <view wx:if="{{!result && !loading && !error}}" class="hint">
    如未能查询，请先在 <text class="code">/XCX/config.js</text> 配置 API 地址。
  </view>
</view>