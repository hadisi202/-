<view class="login-container">
  <!-- 动态星空背景 -->
  <view class="starry-background">
    <view class="star" wx:for="{{stars}}" wx:key="index" style="left: {{item.left}}%; top: {{item.top}}%; animation-delay: {{item.delay}}s;"></view>
  </view>
  
  <!-- 登录内容 -->
  <view class="login-content">
    <!-- Logo区域 -->
    <view class="logo-section">
      <view class="logo-icon">✨</view>
      <text class="app-title">便捷办公助手</text>
      <text class="app-subtitle">让工作更高效</text>
    </view>
    
    <!-- 登录表单 -->
    <view class="login-form">
      <view class="input-group">
        <view class="input-wrapper">
          <input class="login-input" placeholder="请输入用户名" value="{{username}}" bindinput="onUsernameInput" />
          <view class="input-icon">👤</view>
        </view>
      </view>
      
      <view class="input-group">
        <view class="input-wrapper">
          <input class="login-input" placeholder="请输入密码" password="{{!showPassword}}" value="{{password}}" bindinput="onPasswordInput" />
          <view class="input-icon" bindtap="togglePassword">{{showPassword ? '👁️' : '🔒'}}</view>
        </view>
      </view>
      
      <!-- 登录按钮 -->
      <button class="login-btn" bindtap="handleLogin" disabled="{{!canLogin}}">
        <view class="btn-content">
          <text>{{loginLoading ? '登录中...' : '立即登录'}}</text>
          <view class="btn-icon" wx:if="{{!loginLoading}}">→</view>
          <view class="loading-spinner" wx:if="{{loginLoading}}"></view>
        </view>
      </button>
      
      <!-- 游客登录 -->
      <button class="guest-btn" bindtap="handleGuestLogin">
        <text>游客体验</text>
        <text class="guest-tip">(数据每小时清除)</text>
      </button>
    </view>
    
    <!-- 其他选项 -->
    <view class="login-options">
      <text class="option-text" bindtap="showRegister">还没有账号？立即注册</text>
      <text class="option-text" bindtap="showForgotPassword">忘记密码？</text>
    </view>
  </view>
  
  <!-- 版权信息 -->
  <view class="copyright">
    <text>© 2024 便捷办公助手 All Rights Reserved</text>
  </view>
  
  <!-- 注册弹窗 -->
  <view class="modal-overlay" wx:if="{{showRegisterModal}}" bindtap="closeRegisterModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">账号注册</text>
        <view class="modal-close" bindtap="closeRegisterModal">×</view>
      </view>
      
      <view class="modal-body">
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="用户名（至少3位）" value="{{registerData.username}}" bindinput="onRegisterInput" data-field="username" />
            <view class="input-icon">👤</view>
          </view>
          <view class="username-check-status" wx:if="{{usernameCheckStatus}}">
            <text class="check-message {{usernameCheckStatus}}">{{usernameCheckMessage}}</text>
          </view>
        </view>
        
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="密码（至少6位）" password="true" value="{{registerData.password}}" bindinput="onRegisterInput" data-field="password" />
            <view class="input-icon">🔒</view>
          </view>
        </view>
        
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="确认密码" password="true" value="{{registerData.confirmPassword}}" bindinput="onRegisterInput" data-field="confirmPassword" />
            <view class="input-icon">🔒</view>
          </view>
        </view>
        
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="邮箱地址" value="{{registerData.email}}" bindinput="onRegisterInput" data-field="email" />
            <view class="input-icon">📧</view>
          </view>
        </view>
        
        <view class="captcha-group">
          <view class="input-wrapper captcha-input">
            <input class="modal-input" placeholder="验证码" value="{{registerData.captcha}}" bindinput="onRegisterInput" data-field="captcha" />
          </view>
          <view class="captcha-display" bindtap="refreshCaptcha">
            <text class="captcha-text">{{registerData.generatedCaptcha}}</text>
            <text class="captcha-refresh">刷新</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="modal-btn register-btn" bindtap="handleRegister" disabled="{{registerLoading}}">
          <text>{{registerLoading ? '注册中...' : '立即注册'}}</text>
          <view class="loading-spinner" wx:if="{{registerLoading}}"></view>
        </button>
      </view>
    </view>
  </view>
  
  <!-- 忘记密码弹窗 -->
  <view class="modal-overlay" wx:if="{{showForgotModal}}" bindtap="closeForgotModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">找回密码</text>
        <view class="modal-close" bindtap="closeForgotModal">×</view>
      </view>
      
      <view class="modal-body">
        <view class="forgot-tip">
          <text>请输入您的用户名和注册邮箱，我们将发送新密码到您的邮箱</text>
        </view>
        
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="用户名" value="{{forgotData.username}}" bindinput="onForgotInput" data-field="username" />
            <view class="input-icon">👤</view>
          </view>
        </view>
        
        <view class="input-group">
          <view class="input-wrapper">
            <input class="modal-input" placeholder="注册邮箱" value="{{forgotData.email}}" bindinput="onForgotInput" data-field="email" />
            <view class="input-icon">📧</view>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="modal-btn forgot-btn" bindtap="handleForgotPassword" disabled="{{forgotLoading}}">
          <text>{{forgotLoading ? '发送中...' : '发送新密码'}}</text>
          <view class="loading-spinner" wx:if="{{forgotLoading}}"></view>
        </button>
      </view>
    </view>
  </view>
</view>